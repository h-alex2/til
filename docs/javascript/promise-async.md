
## ë™ê¸°ì™€ ë¹„ë™ê¸°

í–„ë²„ê±°ë¥¼ ë¨¹ìœ¼ë ¤ë©´ ë§¥ë„ë‚ ë“œì— ê°€ì„œ _ë°”ë¡œ_ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤. ì•ì˜ ì‚¬ëŒì´ ìŒì‹ì„ ë°›ì§€ ì•Šì•„ë„ ë°”ë¡œ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.  
  

ê·¼ë° ë§Œì•½ ì•ì‚¬ëŒì˜ ì£¼ë¬¸ì´ ë‹¤ ì²˜ë¦¬ë˜ê³  ë‚˜ì„œì•¼ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤ë©´ ì–´ë–»ê²Œë ê¹Œ? íš¨ìœ¨ì ì´ì§€ ëª»í•œ ë°©ë²•ì´ë¼ê³  ìƒê°í•  ìˆ˜ ë°–ì— ì—†ë‹¤. ê·¸ë¦¬ê³  ê³ ê°ë“¤ì˜ ë¶ˆë§Œì´ ìŒ“ì—¬ê°ˆ ê²ƒì´ë‹¤.  

  

ì´ ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ ë¹„ë™ê¸°ì™€ ë™ê¸°ë¥¼ ì´í•´í•  ìˆ˜ ìˆë‹¤.  
  
ë§¥ë„ë‚ ë“œì˜ ì˜ˆë¥¼ ì›¹í˜ì´ì§€ë¡œ ë°”ê¿”ì„œ ìƒê°í•´ë³´ë©´ ë” ì˜ ì•Œ ìˆ˜ ìˆë‹¤. ë„¤ì´ë²„ í™ˆí˜ì´ì§€ë¥¼ ì˜ˆë¡œ ë“¤ì–´ í™ˆí˜ì´ì§€ì— ìˆëŠ” í•˜ë‚˜ í•˜ë‚˜ì˜ ë¦¬ì†ŒìŠ¤ê°€ ì£¼ë¬¸ì´ë¼ê³  ìƒê°í•´ë³´ì. ë™ê¸°ì ìœ¼ë¡œ í™ˆí˜ì´ì§€ë¥¼ êµ¬í˜„í•˜ë©´ ì•ì˜ ì£¼ë¬¸ì´ ì²˜ë¦¬ê°€ ëë‚˜ì•¼ ë‹¤ìŒ ì£¼ë¬¸ì´ ì²˜ë¦¬ë˜ê¸° ë•Œë¬¸ì— í•˜ë‚˜ì”© ìˆœì°¨ì ìœ¼ë¡œ í˜ì´ì§€ì— ë‚˜íƒ€ë‚˜ê²Œ ë˜ê³  ë‹µë‹µí•œ í˜ì´ì§€ê°€ ë  ìˆ˜ ë°–ì— ì—†ë‹¤.  
  


__ë¹„ë™ê¸°ëŠ” ì‘ì—…ì„ ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ íš¨ìœ¨ì ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.__  

ì˜ˆì‹œ
```js 
let response = fetch('myImage.png');
let blob = response.blob();
// display your image blob in the UI somehow
```

ì¸í„°ë„· ì†ë„ê°€ ë¹ ë¥¸ ì»´í“¨í„°ê±°ë‚˜ ì‚¬ì´ì¦ˆê°€ ì•„ì£¼ ì‘ì€ ì´ë¯¸ì§€ë¼ë©´ ë¬¸ì œì—†ì„ ìˆ˜ ìˆì§€ë§Œ ì¸í„°ë„· ì†ë„ê°€ ëŠë¦¬ê±°ë‚˜ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆê°€ ì•„ì£¼ í¬ë‹¤ë©´ ê°€ì ¸ì˜¤ëŠ” ë° ì‹œê°„ì´ ê±¸ë¦¬ê²Œëœë‹¤.  

ë‘ë²ˆì§¸ ì½”ë“œê°€ ì‹¤í–‰ë  ë•Œ ì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œ ë˜ì§€ ì•Šì•„ responseê°€ ì•„ì§ ì œê³µë˜ì§€ ì•Šì€ ìƒí™©ì´ë¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí•  ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ê²½ìš° ë•Œë¬¸ì— ì´ ì½”ë“œëŠ” ë™ê¸°ê°€ ì•„ë‹Œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ì„±í•˜ì—¬ responseê°€ ë°˜í™˜ë˜ê¸° ì „ê¹Œì§€ ê¸°ë‹¤ë¦¬ë„ë¡ ì‘ì„±í•´ì•¼ í•œë‹¤.  
  

## Async Callback
ì½œë°±í•¨ìˆ˜ëŠ” ë‚˜ì¤‘ì— í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¼ëŠ” ëœ»  

ë¹„ë™ê¸° íë¦„ì„ ì œì–´í•˜ëŠ” ê°€ì¥ ì „í†µì ì¸ ë°©ë²•ì€ ì½œë°± í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒ  

callback í•¨ìˆ˜ê°€ ì“°ì´ëŠ” ì˜ˆì‹œë¡œ eventListenerì˜ ë‘ë²ˆì§¸ ì¸ì, setTimeoutì˜ ë‘ë²ˆì§¸ ì¸ìê°€ ìˆë‹¤.  
  
ì˜ˆì‹œ
```js
class UserStorage {

  loginUser(id, password, onSuccess, onError) {
    setTimeout(() => {
      if (
        (id === 'ellie' && password === 'dream') ||
        (id === 'coder' && password === 'academy')
      ) {
        onSuccess(id);
      } else {
        onError(new Error('not fount'));
      }
    }, 2000);
  }

  getRoles(user, onSuccess, onError) {
    setTimeout(() => {
      if (user === 'ellie') {
        onSuccess({ name: 'ellie', role: 'admin' });
      } else {
        onError(new Error('no access'));
      }
    })
  }
}

const userStorage = new UserStorage();
const id = prompt('enter your id');
const password = prompt('enter your password');
userStorage.loginUser(
  id,
  password,
  (user) => {
    userStorage.getRoles(
      user,
      (userWithRole) => {
        alert(`Hello ${userWithRole.name}, you have a ${userWithRole.role} role`)
      },
      (error) => {
        console.log(error);
      })
  },
  (error) => {
  console.log(error)
})
```
IDì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ê³  IDì™€ ë¹„ë°€ë²ˆí˜¸ê°€ ê°ê° ellie, dream ë˜ëŠ” coder, academyë¼ë©´

Hello ellie, you have a admin role ì´ë¼ëŠ” ë¬¸êµ¬ê°€ alertì— ëœ¨ê³  ê·¸ ì™¸ì˜ ë‹¨ì–´ë¼ë©´ ì—ëŸ¬ê°€ ëœ¨ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆë‹¤.  
   


ë¹„ë™ê¸°ë¡œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œëŠ” ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì—ëŸ¬ì— ëŒ€í•œ ë¶„ê¸° ì²˜ë¦¬ê°€ í•„ìˆ˜ì ì´ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° ì‘ì—…ì´ ì—°ì†ëœë‹¤ë©´ ë”ìš± ë³µì¡í•´ì§. ì½œë°± í•¨ìˆ˜ê°€ ì¤‘ì²©ë¨ì— ë”°ë¼ ëìŠ¤ê°€ ê¹Šì–´ì ¸ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê³ , ì—ëŸ¬ í•¸ë“¤ë§ì— ëŒ€í•œ ë¡œì§ê¹Œì§€ ë”í•´ì ¸ ë”ìš± ì´í•´í•˜ê¸° í˜ë“  ì½”ë“œê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.  
  
í”íˆ ì½œë°± ì§€ì˜¥ ì´ë¼ê³  ë¶€ë¦„  
  
## Promise


promiseëŠ” ì € ì•ˆì˜ ë¹„ë™ê¸°ì‘ì—…ì´ ì™„ë£Œë˜ë©´ (ì„±ê³µí•˜ë˜ ì‹¤íŒ¨í•˜ë˜) ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤ëŠ” ì•½ì†ì„ ê°ì²´ì˜ í˜•íƒœë¡œ ë°›ëŠ” ê²ƒ.  

ìƒì„±ëœ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ëŠ” ë¯¸ë˜ì— ë§ì´í•  ì„±ê³µ í˜¹ì€ ì‹¤íŒ¨ì— ëŒ€í•œ ê²°ê³¼ê°’ì„ ë‚˜íƒ€ëƒ„. ë¯¸ë˜ì— ê²¨ë¡œê°€ë¥¼ ëŒë ¤ì£¼ê² ë‹¤ëŠ” ì•½ì†ì´ë‹¤.  

ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ ê°ì²´ëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ ìƒíƒœ ì¤‘ í•˜ë‚˜ì˜ ìƒíƒœë¥¼ ê°€ì§€ë©°, í•œ ë²ˆì´ë¼ë„ ì„±ê³µí•˜ê±°ë‚˜ ì‹¤íŒ¨í•œ í”„ë¡œë¯¸ìŠ¤ëŠ” ì´ˆê¸° ìƒíƒœë¡œ ëŒì•„ê°ˆ ìˆ˜ ì—†ë‹¤. ì¦‰ promiseëŠ” ë¬´ì¡°ê±´ì ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤. (ë§Œë“œëŠ” ìˆœê°„ ì‹¤í–‰ëœë‹¤.)  

promiseëŠ” ê°ì²´ë¼ì„œ ë³€ìˆ˜ì— ë‹´ì„ ìˆ˜ë„ ìˆê³  ì›í•˜ëŠ” ê³³ì— ë„£ì„ ìˆ˜ë„ ìˆë‹¤.  

  

ë‹¨ìˆœíˆ ì½œë°±í—¬ì„ í•´ê²°í•˜ë ¤ê³  ë‚˜ì˜¨ ê²ƒì€ ì•„ë‹ˆë‹¤. ì½œë°±í—¬ì„ ì¡°ê¸ˆ ë” ê°œì„ í•´ì£¼ê¸°ëŠ” í•˜ì§€ë§Œ ê·¸ê±´ ë¶€ìˆ˜ì ì¸ ê²ƒì´ê³  ê·¼ë³¸ì ìœ¼ë¡œëŠ” ì½œë°±í•¨ìˆ˜ì—ì„œ ìˆ˜ë™ì , ì œí•œì ìœ¼ë¡œ í†µì œí•˜ë˜ ìƒí™©ì„ ì¡°ê¸ˆ ë” ëŠ¥ë™ì ìœ¼ë¡œ ê°œì„ í•´ì¤€ë‹¤.  

### Promiseì˜ ìƒíƒœ
- Pending
	- ì•„ì§ ê²°ê³¼ê°€ ì •í•´ì§€ì§€ ì•Šì€ ìƒíƒœ
- Fulfilled
	- ì„±ê³µí•œ ìƒíƒœ
- Rejected
	- ì‹¤íŒ¨í•œ ìƒíƒœ

### Promise ë§Œë“¤ê¸°

1. í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ëŠ”ë‹¤.

```js
const promise = new Promise(function () {
  // something..
});
```

2. í”„ë¡œë¯¸ìŠ¤ ìƒì„±ì í•¨ìˆ˜ì— ì¸ìë¡œ ë“¤ì–´ê°„ í•¨ìˆ˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ resolve, rejectë¼ê³  ë¶€ë¥´ëŠ” 2ê°œì˜ ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. resolveì™€ rejectëŠ” í•¨ìˆ˜ë‹¤.
```js
const promise = new Promise(function (resolve, reject) {
  // do something async here..
});
```

3. í”„ë¡œë¯¸ìŠ¤ ìƒì„±ì í•¨ìˆ˜ì— ì¸ìë¡œ ë“¤ì–´ê°„ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìš°ë¦¬ëŠ” ë¹„ë™ê¸° ì‘ì—…ì„ í•˜ê³ , ë¹„ë™ê¸° ì‘ì—…ì´ ì„±ê³µí•˜ë©´ resolveë¥¼ ì‹¤í–‰í•´ì•¼ í•˜ê³ , ì‹¤íŒ¨í•˜ë©´ rejectë¥¼ ì‹¤í–‰í•´ì•¼ í•œë‹¤.
```js
const promise = new Promise(function (resolve, reject) {
  // do something async here..
  fs.readFile(path, "utf-8", (err, data) => {
    if (err) {
      reject(err);
    } else {
      resolve(data);
    }
  });
});
```

promise ìƒì„± ì˜ˆì‹œ

```js
const promise = new Promise((resolve, reject) => {
  console.log('doing something...');
  setTimeout(() => {
    // resolve('ellie'); //ì‘ë™ì´ ì˜ ë˜ì—ˆë‹¤ë©´ 'ellie'ë¥¼ í˜¸ì¶œ
    reject(new Error('no netword'));
  }, 2000)
})
```
ìƒì„±í•˜ê³  ë‚˜ì„œ  then, catch, finally ë¥¼ ì´ìš©í•´ ê°’ì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.  
  
- then
	- promiseê°€ ì •ìƒì ìœ¼ë¡œ ì˜ ìˆ˜í–‰ì´ ë˜ì–´ì„œ ë§ˆì§€ë§‰ ìµœì¢…ì ìœ¼ë¡œ ì „ë‹¬í•œ ê°’ì´ valueì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœë‹¤. thenì€ ê°’ì„ ë°”ë¡œ ì „ë‹¬í•  ìˆ˜ë„ ìˆê³  promiseë¥¼ ì „ë‹¬í•  ìˆ˜ë„ ìˆë‹¤.
- finally 
	- ì„±ê³µ, ì‹¤íŒ¨ ìƒê´€ì—†ì´ ë¬´ì¡°ê±´ ë§ˆì§€ë§‰ì— ìˆ˜í–‰

```js 
promise
  .then(value => {
    console.log(value);
  }) //thenì„ í˜¸ì¶œí•˜ê²Œë˜ë©´ promiseê°€ ë¦¬í„´ë˜ê³  ê·¸ ë¦¬í„´ëœ promiseì— .catchë¥¼ ë“±ë¡í•˜ëŠ” ê²ƒ
  .catch(error => {
    console.log(error);
  }) 
  .finally(() => {
    console.log('finally')
  });
```

  
ì˜ˆì‹œ
```js
const fetchNumber = new Promise((resolve, reject) => {
  setTimeout(() => resolve(1), 1000)
})

fetchNumber
  .then(num => num * 2) // num = 2
  .then(num => num * 3) // num = 6
  .then(num => {
    return new Promise((resolve, reject) => {
      setTimeout(() => resolve(num - 1), 1000); // num = 5
    });
  })
  .then(num => console.log(num)); // 5
```

```js
const getHen = () =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve('ğŸ“'), 1000);
  });
const getEgg = hen =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${hen} => ğŸ¥š`), 1000);
  });
const cook = egg =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${egg} => ğŸ³`), 1000);
  });

getHen()
  .then(hen => getEgg(hen)) //ë°›ì•„ì˜¤ëŠ” valueë¥¼ ë‹¤ë¥¸ í•¨ìˆ˜ í˜¸ì¶œì— ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ”
  .then(egg => cook(egg)) // ë°‘ê³¼ ê°™ì´ ì¤„ì—¬ì“¸ ìˆ˜ ìˆë‹¤.
  .then(meal => console.log(meal));
  
  
getHen()
.then(getEgg)
.then(cook)
.then(console.log);
```

ì˜¤ë¥˜ ì²˜ë¦¬ ì˜ˆì‹œ
```js
const getHen = () =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve('ğŸ“'), 1000);
  });
const getEgg = hen =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${hen} => ğŸ¥š`), 1000);
  });
const cook = egg =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${egg} => ğŸ³`), 1000);
  });

getHen()
  .then(getEgg)
  .catch(error => {
    return 'ğŸŸ';
  } // ìœ„ thenì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë°”ë¡œ ë°‘ì— catchë¥¼ ë‹¬ì•„ì„œ ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•´ì¤¬ë‹¤.
  .then(cook)
  .then(console.log);
```

ìœ„ ì½œë°±í•¨ìˆ˜ì˜ ì˜ˆì œë¥¼ promiseë¡œ ë³€ê²½í•´ë³´ê¸°
```js
class UserStorage {
  loginUser(id, password) {
    return new Promise((resolve, reject) => {
      setTimeout(() => {
        if (
          (id === 'ellie' && password === 'dream') ||
          (id === 'coder' && password === 'academy')
        ) {
          resolve(id);
        } else {
          reject(new Error('not found'));
        }
      }, 2000);
    });
  }

  getRoles(user) {
    return new Promise((resolve, reject) => {
      setTimeout(() => {
        if (user === 'ellie') {
          resolve({ name: 'ellie', role: 'admin' });
        } else {
          reject(new Error('no access'));
        }
      }, 1000);
    });
  }
}

const userStorage = new UserStorage();
const id = prompt('enter your id');
const password = prompt('enter your password');

userStorage
  .loginUser(id, password)
  .then(userStorage.getRoles)
  .then(user => alert(`Hello ${user.name}`))
  .catch(console.log)
```

## async, await
- syntactic sugarë¼ê³  í•˜ëŠ” ê²ƒ ì¤‘ í•˜ë‚˜ë‹¤. (ëŒ€í‘œì ì¸ ì‹ íƒìŠ¤ ìŠˆê°€ëŠ” classê°€ ìˆë‹¤.)

- í•¨ìˆ˜ ì•ì— asyncë¥¼ ë¶™ì—¬ì£¼ë©´ promiseë¥¼ ì“°ì§€ ì•Šì•„ë„ ìë™ì ìœ¼ë¡œ promiseë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

- í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì´ ë°”ë€ë‹¤. ì¼ë°˜ì ì¸ í•¨ìˆ˜ì™€ ë‹¬ë¦¬ async í•¨ìˆ˜ëŠ” í•­ìƒ Promise ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.

- ë¹„ë™ê¸° ì½”ë“œë¥¼ ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ì½”ë“œì™€ ë”ìš± ìœ ì‚¬í•œ í˜•íƒœë¡œ í¸ë¦¬í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

  
ì˜ˆì‹œ

```js
function resolveAfter2Seconds(x) {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(x);
    }, 2000);
  });
}

async function add(x) {
  console.log("start 2");
  const a = await resolveAfter2Seconds(20);
  console.log("a", a);
  const b = await resolveAfter2Seconds(30);
  console.log("b", b);
  return x + a + b;
}

console.log("start 1");

add(10);

console.log("finish");
```

Async functionì€ ì›ë˜ Promiseë¥¼ ë°˜í™˜í•œë‹¤. ê·¼ë° êµ¬ë¬¸ ë‚´ë¶€ì— returnê°’ì´ ìˆë‹¤ë©´?  
- Async í•¨ìˆ˜ ë‚´ë¶€ì—ì„œì˜ return êµ¬ë¬¸ì€ í•´ë‹¹ Promiseì— ëŒ€í•œ resolve ê°’ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.  ì¦‰, ìœ„ add(10) í•¨ìˆ˜ ì‹¤í–‰ë¬¸ì´ ë°˜í™˜í•˜ëŠ” ê²°ê³¼ëŠ” Promiseì´ë©°, ê·¸ Promiseì˜ resolve ê°’ì€ 60ì´ë‹¤.
  
  

ì˜ˆì‹œ
```js
// Async/Await Example #1

const a = new Promise(function (resolve, reject) {
  setTimeout(function () {
    resolve(666);
  }, 1000);
});

const b = new Promise(function (resolve, reject) {
  setTimeout(function () {
    resolve(777);
  }, 1000);
});

// a, b: promise
async function process() {
  const result = (await a) + (await b);
  console.log(result);
}

process();
```

ì—ëŸ¬í•¸ë“¤ë§ ì˜ˆì‹œ
```js
// Async/Await Example #4
function foo() {
  return new Promise(function (resolve, reject) {
    setTimeout(function () {
      console.log(2);
      reject();
    }, 1000);
  });
}

async function bar() {
  try {
    const a = await foo();
    const b = await foo();
    return a;
  } catch (err) {
    console.error(err);
  }
}
```